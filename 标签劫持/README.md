# 标签劫持

> 逆向标签劫持是一种攻击方式，其中从目标页面链接的页面能够重写该页面，例如将其替换为钓鱼网站。由于用户最初在正确的页面上，他们不太可能注意到页面已被更改为钓鱼网站，特别是如果该网站看起来与目标网站相同。如果用户在这个新页面上进行身份验证，那么他们的凭据（或其他敏感数据）将被发送到钓鱼网站而不是合法网站。

## 摘要

* [工具](#工具)
* [关于漏洞的更多信息](#更多关于漏洞的信息)
* [如何利用](#如何利用)
* [如何寻找](#如何寻找)
* [参考资料](#参考资料)

## 工具

- [发现逆向标签劫持 - Burp 扩展](https://portswigger.net/bappstore/80eb8fd46bf847b4b17861482c2f2a30)

## 关于漏洞的更多信息

在进行标签劫持时，攻击者会搜索插入到网站中并且受其控制的链接。例如，这样的链接可能包含在论坛帖子中。一旦找到这种功能，它会检查链接的 `rel` 属性是否不包含值 `noopener` 且 `target` 属性包含值 `_blank`。如果是这种情况，则网站容易受到标签劫持的攻击。

## 如何利用

```
1. 攻击者在自己控制的网站上发布一个包含以下JS代码的链接：window.opener.location = "http://evil.com"
2. 他诱骗受害者访问该链接，链接在浏览器的新标签页中打开。
3. 同时执行JS代码，后台标签被重定向到网站 evil.com，这很可能是一个钓鱼网站。
4. 如果受害者再次打开后台标签而不查看地址栏，可能会发生他以为自己已登出，因为例如登录页面出现。
5. 受害者尝试重新登录，攻击者接收凭据。
```

## 如何寻找

如前所述，你必须搜索以下链接格式：

```html
<a href="..." target="_blank" rel="" />  
或
<a href="..." target="_blank" />
```

## 参考资料

- [逆向标签劫持 - OWASP, 20.10.20](https://owasp.org/www-community/attacks/Reverse_Tabnabbing)
- [标签劫持 - 维基百科, 20.10.20](https://en.wikipedia.org/wiki/Tabnabbing)
